<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™¾å®¶å¥½äº‹ä¸šéƒ¨ç®¡ç†å¹³å°</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" onerror="(function(){var s=document.createElement('script');s.defer=true;s.src='https://unpkg.com/chart.js@4.4.1/dist/chart.umd.min.js';document.head.appendChild(s);})()"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" referrerpolicy="no-referrer" onerror="(function(){var s=document.createElement('script');s.defer=true;s.src='https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js';document.head.appendChild(s);})()"></script>
    <link rel="stylesheet" href="./assets/css/styles.css">
    <style>
        :root {
            --primary-color: #c3b092;
            --primary-dark: #b5a17e;
            --primary-light: #e6dfd3;
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --light-bg: #f9f7f4;
            --card-shadow: 0 4px 6px rgba(195, 176, 146, 0.1);
            --text-primary: #5a4a3e;
            --text-secondary: #8a7a6a;
            --border-color: #e2d9cf;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom, var(--light-bg), #f0ede8);
            color: var(--text-primary);
            padding-bottom: 50px;
        }
        
        .navbar {
            /* æ·±è‰²åˆ°æµ…è‰²çš„è‡ªç„¶çºµå‘æ¸å˜ï¼ˆæ— ç™½æ„Ÿï¼Œä¿è¯å¯è¯»æ€§ï¼‰ */
            background: linear-gradient(180deg, var(--primary-dark) 0%, var(--primary-color) 100%);
            box-shadow: 0 6px 16px rgba(0,0,0,0.12);
        }
        .navbar .navbar-brand {
            font-size: 20px;
            font-weight: 700;
            letter-spacing: .4px;
            font-family: "Segoe UI", system-ui, -apple-system, "PingFang SC", "Microsoft YaHei", sans-serif;
            text-shadow: 0 1px 0 rgba(0,0,0,0.15);
        }
        /* é¡¶æ å³ä¾§æ“ä½œï¼šä¸»é¢˜/å¯¼å‡º/ç®¡ç†å‘˜ åŒºåˆ†ä¸”éšçš®è‚¤ */
        .navbar .nav-link.theme-switch,
        .navbar .nav-link.admin-toggle {
            padding: 6px 12px;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,.35);
            color: #fff;
            margin-right: 8px;
            line-height: 1.2;
        }
        .navbar .nav-link.theme-switch:hover,
        .navbar .nav-link.admin-toggle:hover {
            background: rgba(255,255,255,.15);
        }
        .navbar .btn-export {
            padding: 6px 14px;
            border-radius: 999px;
            margin-right: 12px;
            font-weight: 600;
            color: #fff;
            background: transparent;
            border: 1px solid rgba(255,255,255,.35);
        }
        .navbar .btn-export:hover { background: rgba(255,255,255,.12); }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.10);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 24px rgba(0,0,0,0.14);
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border-bottom: none;
            font-weight: 600;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0 !important;
        }
        
        .date-selector {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.10);
        }
        .date-selector.date-compact{ padding:10px; }
        .date-selector.date-compact .date-icon{ padding:6px 10px; border-radius:6px; }
        .date-selector.date-compact .date-icon .label{ font-size:12px; }
        
        .metric-card {
            text-align: center;
            padding: 15px;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .metric-label {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .positive { color: var(--emphasis-positive, var(--primary-dark)); font-weight: 600; }
        .negative { color: #e74c3c; font-weight: 600; }
        /* è¡¨æ ¼åŒæ¯”/ç¯æ¯”ï¼šä»…é«˜äº®æ–‡å­—ï¼ˆå»æ‰åº•è‰²ï¼‰ */
        .table td.positive, .table td.negative {
            background: transparent !important;
            color: inherit;
            font-weight: 700;
        }
        .table td.positive { color: var(--primary-dark) !important; text-shadow: 0 0 0 transparent; }
        .table td.negative { color: #d63031 !important; }
        
        .controller-card, .shop-card, .product-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .controller-card:hover, .shop-card:hover, .product-card:hover {
            background-color: var(--primary-light);
        }
        /* å®æ§äººTOP5ï¼šæ•´è¡Œæ¸å˜è¦†ç›–åˆ°å¡ç‰‡å·¦å³ä¸ä¸Šä¸‹è¾¹ç¼˜ */
        .top5-list { margin: -16px -16px; }
        .top5-list .controller-card {
            border: none;
            border-radius: 0;
            padding: 12px 16px;
            background-clip: border-box;
            transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
        }
        /* å»æ‰TOP5è¡Œçš„ä¸­å¿ƒæ¸å˜ï¼Œæ”¹ä¸ºå‰ä¸‰ååœ¨åç§°å‰åŠ é‡‘é“¶é“œemoji */
        .top5-list .controller-card { background: transparent; }
        .top5-list .controller-card h5 { position: relative; padding-left: 2px; }
        .top5-list .controller-card:nth-child(1) h5::before { content: "ğŸ¥‡ "; }
        .top5-list .controller-card:nth-child(2) h5::before { content: "ğŸ¥ˆ "; }
        .top5-list .controller-card:nth-child(3) h5::before { content: "ğŸ¥‰ "; }
        /* æ‚¬åœä¿æŒè½»å¾®ä¸Šæµ®ä¸é˜´å½±ï¼Œé¢œè‰²ä¸å†è¦†ç›–æ–‡æœ¬ */
        .top5-list .controller-card:hover { transform: translateY(-2px); box-shadow: 0 10px 22px rgba(0,0,0,0.14); filter: saturate(1.04) brightness(0.99); background-color: transparent !important; }
        
        .tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 5px;
        }
        
        .tag-high-value {
            background-color: #fff2cc;
            color: #b38f00;
        }
        
        .tag-vip {
            background-color: #e1d5e7;
            color: #674ea7;
        }
        
        .tag-new {
            background-color: #d5e8d4;
            color: #3c763d;
        }
        
        .tag-warning {
            background-color: #fce1e5;
            color: #a94442;
        }
        
        .tab-button {
            padding: 10px 20px;
            border: none;
            background-color: #f8f9fa;
            border-radius: 5px;
            margin-right: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab-button.active {
            background-color: var(--primary-dark);
            color: #fff;
            border-color: var(--primary-dark);
            box-shadow: 0 6px 16px rgba(0,0,0,0.12);
        }
        .tab-button.active:hover { filter: brightness(0.95); }
        
        .table th {
            background: linear-gradient(135deg, rgba(0,0,0,0.0), rgba(0,0,0,0.0));
            color: var(--text-primary);
            font-weight: 700;
            border-bottom: 1px solid var(--border-color);
        }
        /* è¡¨æ ¼é¦–åˆ—ï¼ˆå®ä½“åç§°åˆ—ï¼‰ä¸æ•°æ®åˆ—åšåŒºåˆ† */
        .table thead th:first-child { font-weight: 800; color: var(--text-primary); border-right: 1px solid var(--border-color); }
        .table tbody td:first-child { font-weight: 700; color: var(--text-primary); border-right: 1px solid var(--border-color); white-space: nowrap; }
        /* å®æ§äººåˆ—è¡¨ï¼šæ ‡ç­¾åˆ—ä¸¤ä¾§æ·»åŠ åˆ†éš”ï¼Œé¿å…åŒçº¿å†²çª */
        .table-controllers thead th:first-child, .table-controllers tbody td:first-child { border-right: none; }
        .table-controllers thead th:nth-child(2), .table-controllers tbody td:nth-child(2) { border-left: 1px solid var(--border-color); border-right: 1px solid var(--border-color); }
        
        .progress {
            height: 8px;
            margin-top: 5px;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .negative-info {
            border-left: 4px solid var(--accent-color);
            padding-left: 15px;
            margin-bottom: 15px;
        }
        
        .page-title {
            color: var(--primary-dark);
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .controller-name {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-dark);
        }
        
        .filter-section {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.10);
        }
        
        .info-section {
            display: none;
        }
        
        .info-section.active {
            display: block;
        }
        
        .contract-tab {
            cursor: pointer;
        }
        
        .back-button {
            margin-bottom: 20px;
        }
        
        .breadcrumb {
            background-color: white;
            border-radius: 10px;
            padding: 12px 16px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.10);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .breadcrumb .back-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px; height: 36px;
            border-radius: 8px;
            background: var(--primary-light);
            color: var(--primary-dark);
            border: 1px solid var(--border-color);
            text-decoration: none;
            transition: all .2s ease;
        }
        .breadcrumb .back-link svg { width: 20px; height: 20px; stroke: currentColor; stroke-width: 3; fill: none; stroke-linecap: round; stroke-linejoin: round; }
        .breadcrumb .back-link:hover {
            background: var(--primary-color);
            color: #fff;
            border-color: var(--primary-dark);
        }
        .breadcrumb .breadcrumb-item a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
        }
        .breadcrumb .breadcrumb-item.active {
            color: var(--text-secondary);
            font-weight: 600;
        }
        /* ç¡®ä¿ä¸‹æ‹‰å±‚çº§é«˜äºæ—¥å†ç­‰å¼¹å±‚ */
        .dropdown-menu { z-index: 11001; }
        
        /* æ–°å¢æ ·å¼ */
        .data-mode-selector {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.10);
            border-left: 4px solid var(--primary-color);
        }
        .data-mode-selector .btn-group { gap: 8px; }
        .data-mode-selector .btn-group .btn {
            border-radius: 999px !important;
            padding: 6px 12px;
            font-weight: 500;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            background: #fff;
            transition: all .2s ease;
        }
        .data-mode-selector .btn-group .btn:hover {
            background: var(--primary-light);
            color: var(--primary-dark);
            border-color: var(--primary-color);
        }
        .data-mode-selector .btn-group .btn.active {
            color: #fff;
            background: var(--primary-color);
            border-color: var(--primary-color);
            box-shadow: none;
        }
        
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            background: white;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 20px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        }
        
        .upload-area:hover {
            border-color: var(--primary-color);
            background: var(--primary-light);
        }
        
        .upload-area.dragover {
            border-color: var(--primary-color);
            background: var(--primary-light);
        }
        
        .calendar-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 10px;
            box-shadow: 0 6px 18px rgba(195, 176, 146, 0.2);
            border: 2px solid var(--primary-color);
            z-index: 10000;
            padding: 24px;
            min-width: 360px;
            max-width: 90vw;
            display: none;
        }
        
        .calendar-popup.show {
            display: block;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--primary-light);
        }
        
        .calendar-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        .calendar-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .calendar-close:hover {
            background: rgba(0,0,0,0.05);
            color: var(--text-primary);
        }
        
        .calendar-grid {
            display: grid;
            gap: 12px;
        }
        
        .calendar-year-grid {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .calendar-quarter-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .calendar-month-grid {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .calendar-day-grid {
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        
        .calendar-item {
            padding: 12px 16px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            background: white;
            border: 2px solid transparent;
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .calendar-item:hover {
            background: var(--primary-light);
            color: var(--primary-dark);
            border-color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(195, 176, 146, 0.1);
        }
        
        .calendar-item.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-dark);
            box-shadow: 0 4px 12px rgba(195, 176, 146, 0.15);
        }
        
        .date-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .date-icon:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(195, 176, 146, 0.15);
            border-color: var(--primary-color);
        }
        
        .date-icon.active {
            border-color: var(--primary-color);
            background: var(--primary-light);
        }
        
        .date-icon .icon {
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .date-icon .label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showPage('home')">ç™¾å®¶å¥½äº‹ä¸šéƒ¨ç®¡ç†å¹³å°</a>
            <div class="navbar-nav ms-auto">
                <div class="nav-item dropdown me-3">
                    <a class="nav-link dropdown-toggle theme-switch" href="#" id="themeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        çš®è‚¤
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="themeDropdown">
                        <li><a class="dropdown-item" href="#" onclick="applyTheme('gold')">é»„æ£•</a></li>
                        <li><a class="dropdown-item" href="#" onclick="applyTheme('warm')">æ´‹çº¢</a></li>
                        <li><a class="dropdown-item" href="#" onclick="applyTheme('indigo')">é›è“</a></li>
                    </ul>
                </div>
                <button class="btn btn-sm btn-export" onclick="exportAllToExcel()">å¯¼å‡ºExcel</button>
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle admin-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        ç®¡ç†å‘˜
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#">ä¸ªäººè®¾ç½®</a></li>
                        <li><a class="dropdown-item" href="#">é€€å‡ºç™»å½•</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- ä¸»é¡µé¢ -->
        <div id="home-page">
            <!-- æ•°æ®æ¨¡å¼é€‰æ‹©å™¨ -->
            <div class="data-mode-selector">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h5 class="mb-0">æ•°æ®æ¨¡å¼</h5>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-primary active" id="mockDataBtn" onclick="switchDataMode('mock')">æ¨¡æ‹Ÿæ•°æ®</button>
                            <button type="button" class="btn btn-outline-primary" id="realDataBtn" onclick="switchDataMode('real')">çœŸå®æ•°æ®</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Excelä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                <h5>ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ Excelæ–‡ä»¶</h5>
                <p class="text-muted">æ”¯æŒ .xlsx, .xls æ ¼å¼</p>
                <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
            </div>

            <!-- æ—¥æœŸé€‰æ‹©å™¨ -->
            <div class="date-selector mb-4 date-compact">
                <div class="row align-items-center g-2">
                    <div class="col-md-3 col-12">
                        <h5 class="mb-0">æ—¥æœŸé€‰æ‹©</h5>
                    </div>
                    <div class="col-md-9 col-12 d-flex align-items-center justify-content-between flex-wrap" style="gap:8px">
                        <div class="d-flex align-items-center flex-wrap" style="gap:8px">
                            <div class="date-icon" id="yearIcon" onclick="showYearCalendar()" title="é€‰æ‹©å¹´">
                                <div class="label">å¹´</div>
                            </div>
                            <div class="date-icon" id="quarterIcon" onclick="showQuarterCalendar()" title="é€‰æ‹©å­£">
                                <div class="label">å­£</div>
                            </div>
                            <div class="date-icon" id="monthIcon" onclick="showMonthCalendar()" title="é€‰æ‹©æœˆ">
                                <div class="label">æœˆ</div>
                            </div>
                            <div class="date-icon" id="dayIcon" onclick="showDayCalendar()" title="é€‰æ‹©æ—¥">
                                <div class="label">æ—¥</div>
                            </div>
                            <input type="date" id="fullDateInput" class="form-control form-control-sm" style="width: 160px;" title="é€‰æ‹©å®Œæ•´æ—¥æœŸ">
                        </div>
                        <div class="text-end">
                            <span id="currentSelection" class="text-secondary small">å½“å‰é€‰æ‹©ï¼š-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…³é”®æŒ‡æ ‡å¡ç‰‡ -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“æ—¥GMV</div>
                        <div class="metric-value">Â¥1,245,680</div>
                        <div class="positive">â†‘ 12.5% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“æœˆGMV</div>
                        <div class="metric-value">Â¥28,567,320</div>
                        <div class="positive">â†‘ 8.3% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“å¹´GMV</div>
                        <div class="metric-value">Â¥312,458,790</div>
                        <div class="positive">â†‘ 15.7% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">ç›®æ ‡è¾¾æˆç‡</div>
                        <div class="metric-value">86.5%</div>
                        <div class="progress">
                            <div class="progress-bar bg-success" role="progressbar" style="width: 86.5%" aria-valuenow="86.5" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- å®æ§äººTOP5 -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span>å®æ§äººTOP5</span>
                            <a href="#" class="btn btn-sm" style="color:#fff;border-color:rgba(255,255,255,.6);background:transparent;border:1px solid rgba(255,255,255,.35)" onmouseover="this.style.background='rgba(255,255,255,.15)'" onmouseout="this.style.background='transparent'">æŸ¥çœ‹å…¨éƒ¨</a>
                        </div>
                        <div class="card-body">
                            <div class="list-group top5-list">
                                <a href="#" class="list-group-item list-group-item-action controller-card" onclick="showControllerDetail('å¼ æ˜è½©')">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">å¼ æ˜è½© <span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></h5>
                                        <small>Â¥568,920</small>
                                    </div>
                                    <p class="mb-1">å½“æ—¥GMV</p>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action controller-card" onclick="showControllerDetail('ææ€é›¨')">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">ææ€é›¨ <span class="tag tag-vip">VIPå®¢æˆ·</span></h5>
                                        <small>Â¥452,310</small>
                                    </div>
                                    <p class="mb-1">å½“æ—¥GMV</p>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action controller-card" onclick="showControllerDetail('ç‹å»ºå›½')">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">ç‹å»ºå›½ <span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></h5>
                                        <small>Â¥398,760</small>
                                    </div>
                                    <p class="mb-1">å½“æ—¥GMV</p>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action controller-card" onclick="showControllerDetail('èµµæ™“é›¯')">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">èµµæ™“é›¯ <span class="tag tag-new">æ–°å®¢æˆ·</span></h5>
                                        <small>Â¥356,890</small>
                                    </div>
                                    <p class="mb-1">å½“æ—¥GMV</p>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action controller-card" onclick="showControllerDetail('åˆ˜æµ©ç„¶')">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">åˆ˜æµ©ç„¶ <span class="tag tag-vip">VIPå®¢æˆ·</span></h5>
                                        <small>Â¥321,450</small>
                                    </div>
                                    <p class="mb-1">å½“æ—¥GMV</p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ¸ é“GMVåˆ†å¸ƒ -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">æ¸ é“GMVåˆ†å¸ƒ</div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="channelChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å®æ§äººåˆ—è¡¨ -->
            <div class="card mt-4">
                <div class="card-header">å®æ§äººåˆ—è¡¨</div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover table-controllers">
                            <thead>
                                <tr>
                                    <th>å®æ§äºº</th>
                                    <th>æ ‡ç­¾</th>
                                    <th>å½“æ—¥GMV</th>
                                    <th>å½“æœˆGMV</th>
                                    <th>å½“å¹´GMV</th>
                                    <th>åŒæ¯”</th>
                                    <th>ç¯æ¯”</th>
                                    <th>ç›®æ ‡è¾¾æˆç‡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="controller-card" onclick="showControllerDetail('å¼ æ˜è½©')">
                                    <td>å¼ æ˜è½©</td>
                                    <td><span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></td>
                                    <td>Â¥568,920</td>
                                    <td>Â¥12,458,760</td>
                                    <td>Â¥145,678,920</td>
                                    <td class="positive">+15.2%</td>
                                    <td class="positive">+8.7%</td>
                                    <td>
                                        <div>92.5%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 92.5%" aria-valuenow="92.5" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('ææ€é›¨')">
                                    <td>ææ€é›¨</td>
                                    <td><span class="tag tag-vip">VIPå®¢æˆ·</span></td>
                                    <td>Â¥452,310</td>
                                    <td>Â¥10,245,890</td>
                                    <td>Â¥124,567,890</td>
                                    <td class="positive">+12.8%</td>
                                    <td class="positive">+6.3%</td>
                                    <td>
                                        <div>88.7%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 88.7%" aria-valuenow="88.7" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('ç‹å»ºå›½')">
                                    <td>ç‹å»ºå›½</td>
                                    <td><span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></td>
                                    <td>Â¥398,760</td>
                                    <td>Â¥9,876,540</td>
                                    <td>Â¥112,345,670</td>
                                    <td class="positive">+10.5%</td>
                                    <td class="positive">+5.2%</td>
                                    <td>
                                        <div>85.3%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 85.3%" aria-valuenow="85.3" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('èµµæ™“é›¯')">
                                    <td>èµµæ™“é›¯</td>
                                    <td><span class="tag tag-new">æ–°å®¢æˆ·</span></td>
                                    <td>Â¥356,890</td>
                                    <td>Â¥8,765,430</td>
                                    <td>Â¥98,765,430</td>
                                    <td class="positive">+8.7%</td>
                                    <td class="positive">+4.1%</td>
                                    <td>
                                        <div>82.1%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 82.1%" aria-valuenow="82.1" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('åˆ˜æµ©ç„¶')">
                                    <td>åˆ˜æµ©ç„¶</td>
                                    <td><span class="tag tag-vip">VIPå®¢æˆ·</span></td>
                                    <td>Â¥321,450</td>
                                    <td>Â¥7,654,320</td>
                                    <td>Â¥87,654,320</td>
                                    <td class="positive">+7.3%</td>
                                    <td class="positive">+3.5%</td>
                                    <td>
                                        <div>79.8%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 79.8%" aria-valuenow="79.8" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('é™ˆå°æ˜¥')">
                                    <td>é™ˆå°æ˜¥</td>
                                    <td><span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></td>
                                    <td>Â¥298,760</td>
                                    <td>Â¥6,543,210</td>
                                    <td>Â¥76,543,210</td>
                                    <td class="positive">+6.2%</td>
                                    <td class="positive">+2.8%</td>
                                    <td>
                                        <div>77.5%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 77.5%" aria-valuenow="77.5" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('æ—æ™“æ™“')">
                                    <td>æ—æ™“æ™“</td>
                                    <td><span class="tag tag-new">æ–°å®¢æˆ·</span></td>
                                    <td>Â¥276,540</td>
                                    <td>Â¥5,432,100</td>
                                    <td>Â¥65,432,100</td>
                                    <td class="positive">+5.1%</td>
                                    <td class="positive">+2.1%</td>
                                    <td>
                                        <div>75.2%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 75.2%" aria-valuenow="75.2" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('é»„å¤§ä¼Ÿ')">
                                    <td>é»„å¤§ä¼Ÿ</td>
                                    <td><span class="tag tag-vip">VIPå®¢æˆ·</span></td>
                                    <td>Â¥254,320</td>
                                    <td>Â¥4,321,090</td>
                                    <td>Â¥54,321,090</td>
                                    <td class="positive">+4.3%</td>
                                    <td class="positive">+1.7%</td>
                                    <td>
                                        <div>72.8%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 72.8%" aria-valuenow="72.8" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('å‘¨å°é›…')">
                                    <td>å‘¨å°é›…</td>
                                    <td><span class="tag tag-new">æ–°å®¢æˆ·</span></td>
                                    <td>Â¥232,100</td>
                                    <td>Â¥3,210,980</td>
                                    <td>Â¥43,210,980</td>
                                    <td class="positive">+3.5%</td>
                                    <td class="positive">+1.2%</td>
                                    <td>
                                        <div>70.1%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 70.1%" aria-valuenow="70.1" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="controller-card" onclick="showControllerDetail('å´å¤©å®‡')">
                                    <td>å´å¤©å®‡</td>
                                    <td><span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></td>
                                    <td>Â¥209,870</td>
                                    <td>Â¥2,109,870</td>
                                    <td>Â¥32,109,870</td>
                                    <td class="positive">+2.8%</td>
                                    <td class="positive">+0.9%</td>
                                    <td>
                                        <div>67.5%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-danger" role="progressbar" style="width: 67.5%" aria-valuenow="67.5" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- æ¸ é“å’Œç±»ç›®GMVä¿¡æ¯ -->
            <div class="card mt-4">
                <div class="card-header">æ¸ é“å’Œç±»ç›®GMVä¿¡æ¯</div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>æ¸ é“/ç±»ç›®</th>
                                    <th>å½“æ—¥GMV</th>
                                    <th>å½“æœˆGMV</th>
                                    <th>å½“å¹´GMV</th>
                                    <th>åŒæ¯”</th>
                                    <th>ç¯æ¯”</th>
                                    <th>ç›®æ ‡è¾¾æˆç‡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>å¤©çŒ«</td>
                                    <td>Â¥645,780</td>
                                    <td>Â¥14,567,890</td>
                                    <td>Â¥167,890,450</td>
                                    <td class="positive">+14.2%</td>
                                    <td class="positive">+7.8%</td>
                                    <td>
                                        <div>89.5%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 89.5%" aria-valuenow="89.5" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>äº¬ä¸œ</td>
                                    <td>Â¥345,670</td>
                                    <td>Â¥8,765,430</td>
                                    <td>Â¥98,765,430</td>
                                    <td class="positive">+9.8%</td>
                                    <td class="positive">+4.5%</td>
                                    <td>
                                        <div>82.3%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 82.3%" aria-valuenow="82.3" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>æ‹¼å¤šå¤š</td>
                                    <td>Â¥198,760</td>
                                    <td>Â¥4,567,890</td>
                                    <td>Â¥54,678,900</td>
                                    <td class="positive">+7.5%</td>
                                    <td class="positive">+3.2%</td>
                                    <td>
                                        <div>78.9%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 78.9%" aria-valuenow="78.9" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>æŠ–éŸ³</td>
                                    <td>Â¥287,650</td>
                                    <td>Â¥6,543,210</td>
                                    <td>Â¥76,543,210</td>
                                    <td class="positive">+22.3%</td>
                                    <td class="positive">+12.7%</td>
                                    <td>
                                        <div>95.2%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 95.2%" aria-valuenow="95.2" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>å¿«æ‰‹</td>
                                    <td>Â¥176,540</td>
                                    <td>Â¥3,456,780</td>
                                    <td>Â¥43,456,780</td>
                                    <td class="positive">+18.7%</td>
                                    <td class="positive">+9.8%</td>
                                    <td>
                                        <div>91.8%</div>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 91.8%" aria-valuenow="91.8" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- å®æ§äººè¯¦æƒ…é¡µé¢ -->
        <div id="controller-page" style="display: none;">
            <!-- é¢åŒ…å±‘å¯¼èˆª -->
            <nav aria-label="breadcrumb" class="breadcrumb">
                <a href="#" class="back-link" onclick="showPage('home')" title="è¿”å›ä¸Šä¸€çº§">
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 6 L9 12 L15 18"/></svg>
                </a>
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a href="#" onclick="showPage('home')">é¦–é¡µ</a></li>
                    <li class="breadcrumb-item active" id="controller-breadcrumb">å®æ§äººè¯¦æƒ…</li>
                </ol>
            </nav>

            <!-- å®æ§äººæ ‡é¢˜å’Œæ ‡ç­¾ -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="controller-name" id="controller-name">å¼ æ˜è½© <span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></h1>
                    <p class="text-muted">æ³¨å†Œæ—¶é—´: 2019-03-15 | æœ€åæ´»è·ƒ: 2023-10-26</p>
                </div>
                <div class="date-selector">
                    <input type="date" class="form-control" value="2023-10-26">
                </div>
            </div>

            <!-- å…³é”®æŒ‡æ ‡ -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“æ—¥GMV</div>
                        <div class="metric-value">Â¥568,920</div>
                        <div class="positive">â†‘ 15.2% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“æœˆGMV</div>
                        <div class="metric-value">Â¥12,458,760</div>
                        <div class="positive">â†‘ 12.8% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“å¹´GMV</div>
                        <div class="metric-value">Â¥145,678,920</div>
                        <div class="positive">â†‘ 18.5% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">ç›®æ ‡è¾¾æˆç‡</div>
                        <div class="metric-value">92.5%</div>
                        <div class="progress">
                            <div class="progress-bar bg-success" role="progressbar" style="width: 92.5%" aria-valuenow="92.5" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¿¡æ¯æ ‡ç­¾é¡µ -->
            <div class="card">
                <div class="card-header">
                    <button class="tab-button active" onclick="showInfo('basic')">å®¢æˆ·åŸºæœ¬ä¿¡æ¯</button>
                    <button class="tab-button" onclick="showInfo('team')">å›¢é˜Ÿä¿¡æ¯</button>
                    <button class="tab-button" onclick="showInfo('contract')">ç­¾ç½²åˆåŒ</button>
                </div>
                <div class="card-body">
                    <!-- å®¢æˆ·åŸºæœ¬ä¿¡æ¯ -->
                    <div id="basic-info" class="info-section active">
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>å§“å:</strong> <span id="basic-name">å¼ æ˜è½©</span></p>
                                <p><strong>æ€§åˆ«:</strong> ç”·</p>
                                <p><strong>å¹´é¾„:</strong> 42</p>
                                <p><strong>è”ç³»ç”µè¯:</strong> 138****5678</p>
                                <p><strong>é‚®ç®±:</strong> zhangmx@example.com</p>
                                <p><strong>èº«ä»½è¯å·:</strong> 3301**********1234</p>
                                <p><strong>å©šå§»çŠ¶å†µ:</strong> å·²å©š</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>å®¢æˆ·ç­‰çº§:</strong> é’»çŸ³ä¼šå‘˜</p>
                                <p><strong>å®¢æˆ·ç±»å‹:</strong> ä¼ä¸šå®¢æˆ·</p>
                                <p><strong>æ‰€åœ¨åœ°åŒº:</strong> æµ™æ±Ÿçœæ­å·å¸‚</p>
                                <p><strong>è¯¦ç»†åœ°å€:</strong> æ­å·å¸‚è¥¿æ¹–åŒºæ–‡ä¸‰è·¯XXXå·</p>
                                <p><strong>æ³¨å†Œæ—¶é—´:</strong> 2019-03-15</p>
                                <p><strong>æœ€åä¸‹å•æ—¶é—´:</strong> 2023-10-26 14:32</p>
                                <p><strong>å®¢æˆ·è¯„åˆ†:</strong> 4.8/5.0</p>
                            </div>
                        </div>
                    </div>

                    <!-- å›¢é˜Ÿä¿¡æ¯ -->
                    <div id="team-info" class="info-section">
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>å›¢é˜Ÿè§„æ¨¡:</strong> 45äºº</p>
                                <p><strong>è¿è¥è´Ÿè´£äºº:</strong> ææ€é›¨</p>
                                <p><strong>å®¢æœå›¢é˜Ÿ:</strong> 12äºº</p>
                                <p><strong>è¿è¥å›¢é˜Ÿ:</strong> 18äºº</p>
                                <p><strong>ä»“å‚¨å›¢é˜Ÿ:</strong> 15äºº</p>
                                <p><strong>è®¾è®¡å›¢é˜Ÿ:</strong> 5äºº</p>
                                <p><strong>æ‘„å½±å›¢é˜Ÿ:</strong> 3äºº</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>å›¢é˜Ÿæˆç«‹æ—¶é—´:</strong> 2019-05-20</p>
                                <p><strong>åŠå…¬åœ°å€:</strong> æ­å·å¸‚è¥¿æ¹–åŒºæ–‡ä¸‰è·¯XXXå·</p>
                                <p><strong>å›¢é˜Ÿè¯„åˆ†:</strong> 4.8/5.0</p>
                                <p><strong>æœˆåº¦åŸ¹è®­:</strong> 2æ¬¡/æœˆ</p>
                                <p><strong>å›¢é˜Ÿç¨³å®šæ€§:</strong> é«˜</p>
                                <p><strong>æ ¸å¿ƒæˆå‘˜:</strong> ææ€é›¨ã€ç‹å»ºå›½ã€èµµæ™“é›¯</p>
                                <p><strong>å›¢é˜Ÿç‰¹è‰²:</strong> æ“…é•¿å¤šæ¸ é“è¿è¥ï¼Œæ•°æ®åˆ†æèƒ½åŠ›å¼º</p>
                            </div>
                        </div>
                    </div>

                    <!-- ç­¾ç½²åˆåŒ -->
                    <div id="contract-info" class="info-section">
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card contract-tab text-center" onclick="showContract('dealer')">
                                    <div class="card-body">
                                        <h5 class="card-title">ç»é”€å•†åˆåŒ</h5>
                                        <p class="card-text">3ä»½æœ‰æ•ˆåˆåŒ</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card contract-tab text-center" onclick="showContract('supplier')">
                                    <div class="card-body">
                                        <h5 class="card-title">ä¾›åº”å•†åˆåŒ</h5>
                                        <p class="card-text">2ä»½æœ‰æ•ˆåˆåŒ</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card contract-tab text-center" onclick="showContract('other')">
                                    <div class="card-body">
                                        <h5 class="card-title">å…¶ä»–åˆåŒ</h5>
                                        <p class="card-text">5ä»½æœ‰æ•ˆåˆåŒ</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- åˆåŒè¯¦æƒ…åŒºåŸŸ -->
                        <div id="contract-details">
                            <div class="card">
                                <div class="card-header" id="contract-title">ç»é”€å•†åˆåŒè¯¦æƒ…</div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>åº—é“ºåç§°</th>
                                                    <th>ID</th>
                                                    <th>æ¸ é“</th>
                                                    <th>å¼€åº—æ—¶é—´</th>
                                                    <th>å½“æ—¥GMV</th>
                                                    <th>åŒæ¯”</th>
                                                    <th>ç¯æ¯”</th>
                                                    <th>ç›®æ ‡è¾¾æˆç‡</th>
                                                </tr>
                                            </thead>
                                            <tbody id="contract-table-body">
                                                <!-- ç»é”€å•†åˆåŒæ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GMVä¿¡æ¯ -->
            <div class="card mt-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span>GMVä¿¡æ¯</span>
                    <div>
                        <select class="form-select d-inline-block w-auto" id="channel-filter">
                            <option selected>å…¨éƒ¨æ¸ é“</option>
                            <option>å¤©çŒ«</option>
                            <option>äº¬ä¸œ</option>
                            <option>æ‹¼å¤šå¤š</option>
                            <option>æŠ–éŸ³</option>
                            <option>å¿«æ‰‹</option>
                        </select>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>åº—é“ºåç§°</th>
                                    <th>ID</th>
                                    <th>æ¸ é“</th>
                                    <th>å¼€åº—æ—¶é—´</th>
                                    <th>å½“æ—¥GMV</th>
                                    <th>å½“æœˆGMV</th>
                                    <th>å½“å¹´GMV</th>
                                    <th>åŒæ¯”</th>
                                    <th>ç¯æ¯”</th>
                                    <th>ç›®æ ‡è¾¾æˆç‡</th>
                                </tr>
                            </thead>
                            <tbody id="gmv-table-body">
                                <!-- GMVæ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- è´Ÿé¢ä¿¡æ¯ -->
            <div class="card mt-4">
                <div class="card-header">è´Ÿé¢ä¿¡æ¯</div>
                <div class="card-body">
                    <div class="negative-info">
                        <h5>å•†å“è´¨é‡é—®é¢˜æŠ•è¯‰</h5>
                        <p><strong>æ—¶é—´:</strong> 2023-10-15</p>
                        <p><strong>åº—é“º:</strong> å¼ æ˜è½©æ——èˆ°åº—</p>
                        <p><strong>å•†å“:</strong> ç”·å£«ä¼‘é—²å¤¹å…‹ (ID: MXJ001)</p>
                        <p><strong>é—®é¢˜æè¿°:</strong> å®¢æˆ·åé¦ˆå¤¹å…‹é¢æ–™ä¸æè¿°ä¸ç¬¦ï¼Œå­˜åœ¨è‰²å·®é—®é¢˜</p>
                    </div>
                    <div class="negative-info">
                        <h5>ç‰©æµå»¶è¿ŸæŠ•è¯‰</h5>
                        <p><strong>æ—¶é—´:</strong> 2023-10-08</p>
                        <p><strong>åº—é“º:</strong> å¼ æ˜è½©äº¬ä¸œåº—</p>
                        <p><strong>å•†å“:</strong> ç”·å£«å•†åŠ¡è¡¬è¡« (ID: MSC002)</p>
                        <p><strong>é—®é¢˜æè¿°:</strong> è®¢å•å»¶è¿Ÿå‘è´§ï¼Œè¶…å‡ºæ‰¿è¯ºå‘è´§æ—¶é—´3å¤©</p>
                    </div>
                    <div class="negative-info">
                        <h5>å®¢æœæ€åº¦é—®é¢˜</h5>
                        <p><strong>æ—¶é—´:</strong> 2023-09-25</p>
                        <p><strong>åº—é“º:</strong> å¼ æ˜è½©æ‹¼å¤šå¤šåº—</p>
                        <p><strong>å•†å“:</strong> ç”·å£«ä¼‘é—²è£¤ (ID: MXK003)</p>
                        <p><strong>é—®é¢˜æè¿°:</strong> å®¢æˆ·åé¦ˆå®¢æœå›å¤ä¸åŠæ—¶ï¼Œæ€åº¦å†·æ·¡</p>
                    </div>
                    <div class="negative-info">
                        <h5>å•†å“æè¿°ä¸ç¬¦</h5>
                        <p><strong>æ—¶é—´:</strong> 2023-09-12</p>
                        <p><strong>åº—é“º:</strong> å¼ æ˜è½©æŠ–éŸ³åº—</p>
                        <p><strong>å•†å“:</strong> ç”·å£«è¿åŠ¨é‹ (ID: MXS004)</p>
                        <p><strong>é—®é¢˜æè¿°:</strong> å®¢æˆ·åé¦ˆå•†å“å®é™…æè´¨ä¸é¡µé¢æè¿°ä¸ç¬¦</p>
                    </div>
                </div>
            </div>

            <!-- è¡Œä¸šå¤§ç›˜å¯¹æ¯” -->
            <div class="card mt-4">
                <div class="card-header">è¡Œä¸šå¤§ç›˜å¯¹æ¯”</div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="industryChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- åº—é“ºè¯¦æƒ…é¡µé¢ -->
        <div id="shop-page" style="display: none;">
            <!-- é¢åŒ…å±‘å¯¼èˆª -->
            <nav aria-label="breadcrumb" class="breadcrumb">
                <a href="#" class="back-link" id="back-to-controller-icon" onclick="showPage('home')" title="è¿”å›ä¸Šä¸€çº§">
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 6 L9 12 L15 18"/></svg>
                </a>
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a href="#" onclick="showPage('home')">é¦–é¡µ</a></li>
                    <li class="breadcrumb-item"><a href="#" id="back-to-controller">å®æ§äººè¯¦æƒ…</a></li>
                    <li class="breadcrumb-item active" id="shop-breadcrumb">åº—é“ºè¯¦æƒ…</li>
                </ol>
            </nav>

            <!-- åº—é“ºæ ‡é¢˜ -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="controller-name" id="shop-name">å¼ æ˜è½©æ——èˆ°åº—</h1>
                    <p class="text-muted">åº—é“ºID: <span id="shop-id">ZMX001</span> | å¼€åº—æ—¶é—´: <span id="shop-open-time">2019-06-10</span> | æ¸ é“: <span id="shop-channel">å¤©çŒ«</span></p>
                </div>
                <div class="date-selector">
                    <input type="date" class="form-control" value="2023-10-26">
                </div>
            </div>

            <!-- å…³é”®æŒ‡æ ‡ -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“æ—¥GMV</div>
                        <div class="metric-value">Â¥245,680</div>
                        <div class="positive">â†‘ 18.2% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“æœˆGMV</div>
                        <div class="metric-value">Â¥5,678,920</div>
                        <div class="positive">â†‘ 15.7% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">å½“å¹´GMV</div>
                        <div class="metric-value">Â¥67,890,450</div>
                        <div class="positive">â†‘ 22.3% åŒæ¯”</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card metric-card">
                        <div class="metric-label">ç›®æ ‡è¾¾æˆç‡</div>
                        <div class="metric-value">94.2%</div>
                        <div class="progress">
                            <div class="progress-bar bg-success" role="progressbar" style="width: 94.2%" aria-valuenow="94.2" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å•†å“åˆ—è¡¨ -->
            <div class="card">
                <div class="card-header">å•†å“åˆ—è¡¨</div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>å•†å“åç§°</th>
                                    <th>å•†å“ID</th>
                                    <th>ä¸Šæ¶æ—¶é—´</th>
                                    <th>å½“æ—¥é”€é‡</th>
                                    <th>å½“æ—¥GMV</th>
                                    <th>å½“æœˆé”€é‡</th>
                                    <th>å½“æœˆGMV</th>
                                    <th>åº“å­˜</th>
                                    <th>çŠ¶æ€</th>
                                </tr>
                            </thead>
                            <tbody id="product-table-body">
                                <!-- å•†å“æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- å•†å“é”€å”®è¶‹åŠ¿ -->
            <div class="card mt-4">
                <div class="card-header">å•†å“é”€å”®è¶‹åŠ¿</div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="productTrendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ—¥å†å¼¹çª— -->
    <div id="calendarPopup" class="calendar-popup">
        <div class="calendar-header">
            <h5 class="calendar-title" id="calendarTitle">é€‰æ‹©å¹´ä»½</h5>
            <button class="calendar-close" onclick="closeCalendar()">&times;</button>
        </div>
        <div id="calendarContent" class="calendar-grid"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script>if(!window.bootstrap){var s=document.createElement('script');s.src='https://unpkg.com/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js';document.body.appendChild(s);}</script>
    <script src="./assets/js/app.js"></script>
    <script>
        // inline script retained to avoid breaking; migrated logic is in assets/js/app.js
        const themes = {
            gold: {
                '--primary-color':'#c3b092','--primary-dark':'#a67c52','--primary-light':'#e6dfd3','--light-bg':'#f9f7f4','--text-primary':'#5a4a3e','--text-secondary':'#8a7a6a','--border-color':'#e2d9cf',
                '--emphasis-positive':'#a5662b'
            },
            warm: {
                '--primary-color':'#d87a6e','--primary-dark':'#c45548','--primary-light':'#f3d4cf','--light-bg':'#fff7f6','--text-primary':'#5a3a36','--text-secondary':'#845c56','--border-color':'#f0d0cb',
                '--emphasis-positive':'#c45548'
            },
            indigo: {
                '--primary-color':'#6b83d8','--primary-dark':'#4b61c4','--primary-light':'#d9def6','--light-bg':'#f6f7ff','--text-primary':'#343a5a','--text-secondary':'#5a618a','--border-color':'#d0d4f0',
                '--emphasis-positive':'#4b61c4'
            }
        };

        function applyTheme(name){
            const theme = themes[name] || themes.gold;
            const root = document.documentElement;
            Object.entries(theme).forEach(([k,v])=> root.style.setProperty(k,v));
            localStorage.setItem('selectedTheme', name);
            // ä¸»é¢˜åˆ‡æ¢ååˆ·æ–°å›¾è¡¨é…è‰²
            try { updateChartColors(); } catch(e) {}
        }

        // å…¨å±€å˜é‡
        let currentDataMode = 'mock'; // 'mock' æˆ– 'real'
        let currentSheet = null;
        let currentYear = new Date().getFullYear();
        let currentQuarter = Math.ceil((new Date().getMonth() + 1) / 3);
        let currentMonth = new Date().getMonth() + 1;
        let currentDay = new Date().getDate();

        // æ•°æ®æ¨¡å¼åˆ‡æ¢
        function switchDataMode(mode) {
            currentDataMode = mode;
            const mockBtn = document.getElementById('mockDataBtn');
            const realBtn = document.getElementById('realDataBtn');
            mockBtn.classList.toggle('active', mode === 'mock');
            realBtn.classList.toggle('active', mode === 'real');
            // ARIA & å¯è®¿é—®æ€§
            mockBtn.setAttribute('aria-pressed', mode === 'mock');
            realBtn.setAttribute('aria-pressed', mode === 'real');
            
            if (mode === 'mock') {
                // æ˜¾ç¤ºæ¨¡æ‹Ÿæ•°æ®
                loadMockData();
            } else {
                // æ˜¾ç¤ºçœŸå®æ•°æ®ï¼ˆå¦‚æœæœ‰ä¸Šä¼ çš„Excelï¼‰
                if (currentSheet) {
                    loadRealData();
                } else {
                    alert('è¯·å…ˆä¸Šä¼ Excelæ–‡ä»¶');
                    switchDataMode('mock');
                }
            }
        }

        // æ–‡ä»¶ä¸Šä¼ å¤„ç†
        function handleFileUpload(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    currentSheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);
                    
                    // æ›´æ–°ä¸Šä¼ åŒºåŸŸæ˜¾ç¤º
                    document.getElementById('uploadArea').innerHTML = `
                        <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                        <h5>æ–‡ä»¶ä¸Šä¼ æˆåŠŸ</h5>
                        <p class="text-muted">å·²åŠ è½½ ${currentSheet.length} è¡Œæ•°æ®</p>
                        <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">é‡æ–°ä¸Šä¼ </button>
                    `;
                    
                    // åˆ‡æ¢åˆ°çœŸå®æ•°æ®æ¨¡å¼
                    switchDataMode('real');
                } catch (error) {
                    alert('æ–‡ä»¶è§£æå¤±è´¥: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // åŠ è½½çœŸå®æ•°æ®
        function loadRealData() {
            if (!currentSheet) return;
            
            // æ›´æ–°æŒ‡æ ‡å¡ç‰‡
            updateMetricsFromRealData();
            
            // æ›´æ–°è¡¨æ ¼
            updateTableFromRealData();
            
            // æ›´æ–°å›¾è¡¨
            updateChartsFromRealData();
        }

        // ä»çœŸå®æ•°æ®æ›´æ–°æŒ‡æ ‡
        function updateMetricsFromRealData() {
            if (!currentSheet) return;
            
            const yearGMV = currentSheet.reduce((sum, row) => sum + (row['å¹´GMV'] || 0), 0);
            const quarterGMV = currentSheet.reduce((sum, row) => sum + (row['å­£GMV'] || 0), 0);
            const monthGMV = currentSheet.reduce((sum, row) => sum + (row['æœˆGMV'] || 0), 0);
            const dayGMV = currentSheet.reduce((sum, row) => sum + (row['å½“æ—¥GMV'] || 0), 0);
            
            // æ›´æ–°æŒ‡æ ‡æ˜¾ç¤º
            const metricCards = document.querySelectorAll('.metric-card .metric-value');
            if (metricCards[0]) metricCards[0].textContent = 'Â¥' + formatNumber(dayGMV);
            if (metricCards[1]) metricCards[1].textContent = 'Â¥' + formatNumber(monthGMV);
            if (metricCards[2]) metricCards[2].textContent = 'Â¥' + formatNumber(yearGMV);
        }

        // ä»çœŸå®æ•°æ®æ›´æ–°è¡¨æ ¼
        function updateTableFromRealData() {
            if (!currentSheet) return;
            
            // æ›´æ–°å®æ§äººåˆ—è¡¨è¡¨æ ¼
            const tbody = document.querySelector('#home-page .table tbody');
            if (tbody) {
                tbody.innerHTML = '';
                currentSheet.slice(0, 10).forEach((row, index) => {
                    const tr = document.createElement('tr');
                    tr.className = 'controller-card';
                    tr.onclick = () => showControllerDetail(row['å®æ§äºº'] || 'æœªçŸ¥');
                    tr.innerHTML = `
                        <td>${row['å®æ§äºº'] || '-'}</td>
                        <td><span class="tag tag-high-value">é«˜ä»·å€¼å®¢æˆ·</span></td>
                        <td>${formatNumber(row['æœˆç›®æ ‡'] || 0)}ä¸‡</td>
                        <td>${formatNumber(row['æœˆGMV'] || 0)}ä¸‡</td>
                        <td class="${(row['æœˆç¯æ¯”'] || 0) >= 0 ? 'positive' : 'negative'}">
                            ${(row['æœˆç¯æ¯”'] || 0).toFixed(1)}%
                        </td>
                        <td>${formatNumber(row['å¹´GMV'] || 0)}ä¸‡</td>
                        <td>${formatNumber(row['å½“æ—¥GMV'] || 0)}ä¸‡</td>
                        <td class="${(row['æ—¥ç¯æ¯”'] || 0) >= 0 ? 'positive' : 'negative'}">
                            ${(row['æ—¥ç¯æ¯”'] || 0).toFixed(1)}%
                        </td>
                        <td>${(row['è¾¾æˆç‡'] || 0).toFixed(1)}%</td>
                    `;
                    tbody.appendChild(tr);
                });
            }
        }

        // ä»çœŸå®æ•°æ®æ›´æ–°å›¾è¡¨
        function updateChartsFromRealData() {
            if (!currentSheet) return;
            
            // è¿™é‡Œå¯ä»¥æ ¹æ®çœŸå®æ•°æ®æ›´æ–°å›¾è¡¨
            // ç”±äºExcelæ•°æ®ç»“æ„å¯èƒ½ä¸å®Œæ•´ï¼Œä¿æŒåŸæœ‰å›¾è¡¨ä¸å˜
        }

        // åŠ è½½æ¨¡æ‹Ÿæ•°æ®ï¼ˆé¿å…æ•´é¡µåˆ·æ–°ï¼Œç›´æ¥é‡ç½®è§†å›¾ï¼‰
        function loadMockData() {
            // æ¢å¤æŒ‡æ ‡å±•ç¤ºï¼ˆå†™å›é™æ€å ä½ï¼‰
            const metricCards = document.querySelectorAll('.metric-card .metric-value');
            if (metricCards[0]) metricCards[0].textContent = 'Â¥1,245,680';
            if (metricCards[1]) metricCards[1].textContent = 'Â¥28,567,320';
            if (metricCards[2]) metricCards[2].textContent = 'Â¥312,458,790';

            // è¡¨æ ¼æ¢å¤ä¸ºåŸå…ˆæ¨¡æ‹Ÿæ•°æ®æ— éœ€å˜åŠ¨ï¼›è‹¥è¢«çœŸå®æ•°æ®è¦†ç›–ï¼Œè¿™é‡Œä¸å¼ºåˆ¶å›æ»š
        }

        // æ ¼å¼åŒ–æ•°å­—
        function formatNumber(num) {
            return (num || 0).toLocaleString();
        }

        // æ—¥å†ç›¸å…³å‡½æ•°
        let calendarJustOpened = false;
        function showYearCalendar() {
            const popup = document.getElementById('calendarPopup');
            const title = document.getElementById('calendarTitle');
            const content = document.getElementById('calendarContent');
            const trigger = document.getElementById('yearIcon');
            
            title.textContent = 'é€‰æ‹©å¹´ä»½';
            content.className = 'calendar-grid calendar-year-grid';
            
            let yearItems = '';
            for (let year = currentYear - 5; year <= currentYear + 5; year++) {
                const isSelected = year === currentYear ? 'selected' : '';
                yearItems += `<div class="calendar-item ${isSelected}" onclick="selectYear(${year})">${year}å¹´</div>`;
            }
            content.innerHTML = yearItems;
            
            showCalendar(popup, trigger);
        }

        function showQuarterCalendar() {
            const popup = document.getElementById('calendarPopup');
            const title = document.getElementById('calendarTitle');
            const content = document.getElementById('calendarContent');
            const trigger = document.getElementById('quarterIcon');
            
            title.textContent = 'é€‰æ‹©å­£åº¦';
            content.className = 'calendar-grid calendar-quarter-grid';
            
            let quarterItems = '';
            for (let q = 1; q <= 4; q++) {
                const isSelected = q === currentQuarter ? 'selected' : '';
                quarterItems += `<div class="calendar-item ${isSelected}" onclick="selectQuarter(${q})">Q${q}</div>`;
            }
            content.innerHTML = quarterItems;
            
            showCalendar(popup, trigger);
        }

        function showMonthCalendar() {
            const popup = document.getElementById('calendarPopup');
            const title = document.getElementById('calendarTitle');
            const content = document.getElementById('calendarContent');
            const trigger = document.getElementById('monthIcon');
            
            title.textContent = 'é€‰æ‹©æœˆä»½';
            content.className = 'calendar-grid calendar-month-grid';
            
            let monthItems = '';
            for (let m = 1; m <= 12; m++) {
                const isSelected = m === currentMonth ? 'selected' : '';
                monthItems += `<div class="calendar-item ${isSelected}" onclick="selectMonth(${m})">${m}æœˆ</div>`;
            }
            content.innerHTML = monthItems;
            
            showCalendar(popup, trigger);
        }

        function showDayCalendar() {
            const popup = document.getElementById('calendarPopup');
            const title = document.getElementById('calendarTitle');
            const content = document.getElementById('calendarContent');
            const trigger = document.getElementById('dayIcon');
            
            title.textContent = 'é€‰æ‹©æ—¥æœŸ';
            content.className = 'calendar-grid calendar-day-grid';
            
            let dayItems = '';
            for (let d = 1; d <= 31; d++) {
                const isSelected = d === currentDay ? 'selected' : '';
                dayItems += `<div class="calendar-item ${isSelected}" onclick="selectDay(${d})">${d}æ—¥</div>`;
            }
            content.innerHTML = dayItems;
            
            showCalendar(popup, trigger);
        }

        function showCalendar(popup, trigger) {
            if (trigger) {
                const triggerRect = trigger.getBoundingClientRect();
                
                // è·å–å¼¹çª—å®é™…å°ºå¯¸
                popup.style.display = 'block';
                popup.style.visibility = 'hidden';
                popup.classList.add('show');
                
                const popupWidth = popup.offsetWidth;
                
                // è®¡ç®—æŒ‰é’®åº•éƒ¨ä¸­å¿ƒç‚¹ï¼Œå¼¹çª—æ˜¾ç¤ºåœ¨ä¸‹æ–¹å¹¶æ°´å¹³å±…ä¸­
                const left = triggerRect.left + (triggerRect.width / 2) - (popupWidth / 2);
                const top = triggerRect.bottom + 8; // ä¸‹æ–¹ 8px é—´è·
                
                popup.style.top = top + 'px';
                popup.style.left = left + 'px';
                popup.style.transform = 'none';
            }
            
            // æ˜¾ç¤ºå¼¹çª—
            popup.style.visibility = 'visible';
            // å¼¹çª—å†…ç‚¹å‡»ä¸å…³é—­
            popup.onclick = function(e){ e.stopPropagation(); };
            // æ‰“å¼€åçš„çŸ­æš‚å¿½ç•¥ï¼Œé¿å…å½“å‰ç‚¹å‡»è¢«è§†ä¸ºå¤–éƒ¨ç‚¹å‡»
            calendarJustOpened = true;
            setTimeout(() => { calendarJustOpened = false; }, 50);
            // é‡ç»‘å¤–éƒ¨å…³é—­
            document.removeEventListener('click', closeCalendarOnOutsideClick, true);
            document.addEventListener('click', closeCalendarOnOutsideClick, true);
        }

        function closeCalendar() {
            const popup = document.getElementById('calendarPopup');
            popup.style.display = 'none';
            popup.classList.remove('show');
            document.removeEventListener('click', closeCalendarOnOutsideClick);
        }

        function closeCalendarOnOutsideClick(e) {
            if (calendarJustOpened) return;
            const popup = document.getElementById('calendarPopup');
            if (!popup.contains(e.target)) {
                closeCalendar();
            }
        }

        function selectYear(year) {
            currentYear = year;
            closeCalendar();
            // ä¿æŒç®€æ´ï¼šä¸ä¾èµ– event.targetï¼Œé¿å…è·¨æµè§ˆå™¨é—®é¢˜
            updateCurrentSelectionLabel();
        }

        function selectQuarter(quarter) {
            currentQuarter = quarter;
            closeCalendar();
            // ä¸ä¾èµ– event.target
            updateCurrentSelectionLabel();
        }

        function selectMonth(month) {
            currentMonth = month;
            closeCalendar();
            // ä¸ä¾èµ– event.target
            updateCurrentSelectionLabel();
        }

        function selectDay(day) {
            currentDay = day;
            closeCalendar();
            // ä¸ä¾èµ– event.target
            updateCurrentSelectionLabel();
        }

        function updateCurrentSelectionLabel(){
            const text = `${currentYear}å¹´ Q${currentQuarter} ${currentMonth}æœˆ ${currentDay}æ—¥`;
            const el = document.getElementById('currentSelection');
            if (el) el.textContent = `å½“å‰é€‰æ‹©ï¼š${text}`;
        }

        // å®Œæ•´æ—¥æœŸè¾“å…¥ç»‘å®š
        document.addEventListener('change', function(e){
            if (e.target && e.target.id === 'fullDateInput'){
                const d = new Date(e.target.value);
                if (!isNaN(d)){
                    currentYear = d.getFullYear();
                    currentMonth = d.getMonth() + 1;
                    currentDay = d.getDate();
                    currentQuarter = Math.ceil(currentMonth/3);
                    updateCurrentSelectionLabel();
                }
            }
        });

        // å¯¼å‡ºå…¨é‡åº•è¡¨ï¼ˆå¯é‡æ–°å¯¼å…¥ï¼‰
        function exportAllToExcel(){
            try{
                const wb = XLSX.utils.book_new();

                // 1) å®æ§äººåˆ—è¡¨ï¼šä»å½“å‰å¯è§è¡¨æ ¼æŠ“å–ï¼ˆä¿è¯ä¸é¡µé¢ä¸€è‡´ï¼‰
                const table = document.querySelector('#home-page table');
                if (table){
                    const wsDashboard = XLSX.utils.table_to_sheet(table);
                    XLSX.utils.book_append_sheet(wb, wsDashboard, 'å®æ§äººåˆ—è¡¨');
                }

                // 2) æŒ‡æ ‡å¡ç‰‡å¿«ç…§
                const snapshot = [];
                snapshot.push({ æŒ‡æ ‡: 'å¹´GMV', æ•°å€¼: (document.getElementById('year-gmv')||{}).textContent||'' });
                snapshot.push({ æŒ‡æ ‡: 'å­£GMV', æ•°å€¼: (document.getElementById('quarter-gmv')||{}).textContent||'' });
                snapshot.push({ æŒ‡æ ‡: 'æœˆGMV', æ•°å€¼: (document.getElementById('month-gmv')||{}).textContent||'' });
                snapshot.push({ æŒ‡æ ‡: 'æ—¥GMV', æ•°å€¼: (document.getElementById('day-gmv')||{}).textContent||'' });
                const wsKPI = XLSX.utils.json_to_sheet(snapshot);
                XLSX.utils.book_append_sheet(wb, wsKPI, 'æŒ‡æ ‡å¿«ç…§');

                // 3) Top5 æ’è¡Œï¼ˆä»åˆ—è¡¨DOMæå–ï¼‰
                const top5 = [];
                document.querySelectorAll('#top5Ranking .ranking-item').forEach((item, idx)=>{
                    const name = item.querySelector('.ranking-name')?.textContent||'';
                    const value = item.querySelector('.ranking-value')?.textContent||'';
                    top5.push({ æ’å: idx+1, å®æ§äºº: name, GMV: value });
                });
                if (top5.length){
                    const wsTop5 = XLSX.utils.json_to_sheet(top5);
                    XLSX.utils.book_append_sheet(wb, wsTop5, 'Top5æ’è¡Œ');
                }

                // 4) æ¨¡æ‹Ÿæ•°æ®æºï¼ˆshopsã€productsã€contractDataã€controllersï¼‰
                if (typeof controllers !== 'undefined'){
                    const controllersArr = Object.entries(controllers).map(([k,v])=>({
                        key: k,
                        name: v.name, tag: v.tag, tagText: v.tagText,
                        dailyGMV: v.dailyGMV, monthlyGMV: v.monthlyGMV, yearlyGMV: v.yearlyGMV,
                        yoy: v.yoy, mom: v.mom, targetRate: v.targetRate,
                        registerDate: v.registerDate, lastActive: v.lastActive
                    }));
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(controllersArr), 'controllers');
                }
                if (typeof shops !== 'undefined'){
                    const shopsArr = [];
                    Object.entries(shops).forEach(([owner, arr])=>{
                        arr.forEach(s=> shopsArr.push({ owner, ...s }));
                    });
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(shopsArr), 'shops');
                }
                if (typeof products !== 'undefined'){
                    const productsArr = [];
                    Object.entries(products).forEach(([shopId, arr])=>{
                        arr.forEach(p=> productsArr.push({ shopId, ...p }));
                    });
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(productsArr), 'products');
                }
                if (typeof contractData !== 'undefined'){
                    Object.entries(contractData).forEach(([type, arr])=>{
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(arr), `contract_${type}`);
                    });
                }

                // 5) çœŸå®æ•°æ®ï¼ˆå¦‚å·²ä¸Šä¼ Excelï¼‰
                if (Array.isArray(currentSheet) && currentSheet.length){
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(currentSheet), 'å¯¼å…¥åº•è¡¨');
                }

                // 6) å…ƒä¿¡æ¯ï¼ˆå½“å‰é€‰æ‹©ï¼‰
                const meta = [{ year: currentYear, quarter: currentQuarter, month: currentMonth, day: currentDay }];
                XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(meta), 'meta');

                const filename = `å…¨é‡å¯¼å‡º_${currentYear}Q${currentQuarter}_${currentMonth}æœˆ${currentDay}æ—¥.xlsx`;
                XLSX.writeFile(wb, filename);
            }catch(err){
                alert('å¯¼å‡ºå¤±è´¥ï¼š' + err.message);
            }
        }

        // æ¨¡æ‹Ÿæ•°æ®
        const controllers = {
            'å¼ æ˜è½©': {
                name: 'å¼ æ˜è½©',
                tag: 'tag-high-value',
                tagText: 'é«˜ä»·å€¼å®¢æˆ·',
                dailyGMV: 'Â¥568,920',
                monthlyGMV: 'Â¥12,458,760',
                yearlyGMV: 'Â¥145,678,920',
                yoy: '+15.2%',
                mom: '+8.7%',
                targetRate: '92.5%',
                registerDate: '2019-03-15',
                lastActive: '2023-10-26'
            },
            'ææ€é›¨': {
                name: 'ææ€é›¨',
                tag: 'tag-vip',
                tagText: 'VIPå®¢æˆ·',
                dailyGMV: 'Â¥452,310',
                monthlyGMV: 'Â¥10,245,890',
                yearlyGMV: 'Â¥124,567,890',
                yoy: '+12.8%',
                mom: '+6.3%',
                targetRate: '88.7%',
                registerDate: '2020-05-20',
                lastActive: '2023-10-26'
            },
            'ç‹å»ºå›½': {
                name: 'ç‹å»ºå›½',
                tag: 'tag-high-value',
                tagText: 'é«˜ä»·å€¼å®¢æˆ·',
                dailyGMV: 'Â¥398,760',
                monthlyGMV: 'Â¥9,876,540',
                yearlyGMV: 'Â¥112,345,670',
                yoy: '+10.5%',
                mom: '+5.2%',
                targetRate: '85.3%',
                registerDate: '2018-11-12',
                lastActive: '2023-10-25'
            },
            'èµµæ™“é›¯': {
                name: 'èµµæ™“é›¯',
                tag: 'tag-new',
                tagText: 'æ–°å®¢æˆ·',
                dailyGMV: 'Â¥356,890',
                monthlyGMV: 'Â¥8,765,430',
                yearlyGMV: 'Â¥98,765,430',
                yoy: '+8.7%',
                mom: '+4.1%',
                targetRate: '82.1%',
                registerDate: '2022-02-18',
                lastActive: '2023-10-26'
            },
            'åˆ˜æµ©ç„¶': {
                name: 'åˆ˜æµ©ç„¶',
                tag: 'tag-vip',
                tagText: 'VIPå®¢æˆ·',
                dailyGMV: 'Â¥321,450',
                monthlyGMV: 'Â¥7,654,320',
                yearlyGMV: 'Â¥87,654,320',
                yoy: '+7.3%',
                mom: '+3.5%',
                targetRate: '79.8%',
                registerDate: '2019-07-25',
                lastActive: '2023-10-24'
            }
        };

        const shops = {
            'å¼ æ˜è½©': [
                { name: 'å¼ æ˜è½©æ——èˆ°åº—', id: 'ZMX001', channel: 'å¤©çŒ«', openTime: '2019-06-10', dailyGMV: 'Â¥245,680', monthlyGMV: 'Â¥5,678,920', yearlyGMV: 'Â¥67,890,450', yoy: '+18.2%', mom: '+9.5%', targetRate: '94.2%' },
                { name: 'å¼ æ˜è½©äº¬ä¸œåº—', id: 'ZMX002', channel: 'äº¬ä¸œ', openTime: '2019-08-15', dailyGMV: 'Â¥156,790', monthlyGMV: 'Â¥3,456,780', yearlyGMV: 'Â¥42,345,670', yoy: '+12.5%', mom: '+6.8%', targetRate: '88.7%' },
                { name: 'å¼ æ˜è½©æ‹¼å¤šå¤šåº—', id: 'ZMX003', channel: 'æ‹¼å¤šå¤š', openTime: '2020-03-20', dailyGMV: 'Â¥98,450', monthlyGMV: 'Â¥2,345,670', yearlyGMV: 'Â¥28,765,430', yoy: '+22.3%', mom: '+12.7%', targetRate: '96.5%' },
                { name: 'å¼ æ˜è½©æŠ–éŸ³åº—', id: 'ZMX004', channel: 'æŠ–éŸ³', openTime: '2021-05-12', dailyGMV: 'Â¥68,000', monthlyGMV: 'Â¥1,567,890', yearlyGMV: 'Â¥18,765,430', yoy: '+45.2%', mom: '+28.9%', targetRate: '102.3%' }
            ],
            'ææ€é›¨': [
                { name: 'ææ€é›¨æ——èˆ°åº—', id: 'LSY001', channel: 'å¤©çŒ«', openTime: '2020-07-10', dailyGMV: 'Â¥198,760', monthlyGMV: 'Â¥4,567,890', yearlyGMV: 'Â¥54,678,900', yoy: '+15.7%', mom: '+8.3%', targetRate: '91.2%' },
                { name: 'ææ€é›¨äº¬ä¸œåº—', id: 'LSY002', channel: 'äº¬ä¸œ', openTime: '2020-09-18', dailyGMV: 'Â¥134,560', monthlyGMV: 'Â¥3,098,760', yearlyGMV: 'Â¥37,654,320', yoy: '+10.8%', mom: '+5.4%', targetRate: '86.5%' },
                { name: 'ææ€é›¨æ‹¼å¤šå¤šåº—', id: 'LSY003', channel: 'æ‹¼å¤šå¤š', openTime: '2021-02-14', dailyGMV: 'Â¥76,540', monthlyGMV: 'Â¥1,876,540', yearlyGMV: 'Â¥22,345,670', yoy: '+18.9%', mom: '+10.2%', targetRate: '89.7%' },
                { name: 'ææ€é›¨å¿«æ‰‹åº—', id: 'LSY004', channel: 'å¿«æ‰‹', openTime: '2022-01-08', dailyGMV: 'Â¥42,310', monthlyGMV: 'Â¥987,650', yearlyGMV: 'Â¥11,876,540', yoy: '+32.5%', mom: '+18.7%', targetRate: '95.8%' }
            ]
        };

        const products = {
            'ZMX001': [
                { name: 'ç”·å£«ä¼‘é—²å¤¹å…‹', id: 'MXJ001', listTime: '2023-03-15', dailySales: 156, dailyGMV: 'Â¥45,680', monthlySales: 3456, monthlyGMV: 'Â¥1,023,450', stock: 2345, status: 'åœ¨å”®' },
                { name: 'ç”·å£«å•†åŠ¡è¡¬è¡«', id: 'MSC002', listTime: '2023-02-10', dailySales: 203, dailyGMV: 'Â¥38,760', monthlySales: 4567, monthlyGMV: 'Â¥876,540', stock: 1876, status: 'åœ¨å”®' },
                { name: 'ç”·å£«ä¼‘é—²è£¤', id: 'MXK003', listTime: '2023-04-22', dailySales: 178, dailyGMV: 'Â¥32,450', monthlySales: 3987, monthlyGMV: 'Â¥723,450', stock: 2156, status: 'åœ¨å”®' },
                { name: 'ç”·å£«è¿åŠ¨é‹', id: 'MXS004', listTime: '2023-01-05', dailySales: 134, dailyGMV: 'Â¥56,780', monthlySales: 2876, monthlyGMV: 'Â¥1,234,560', stock: 1567, status: 'åœ¨å”®' },
                { name: 'ç”·å£«ç¾½ç»’æœ', id: 'MYR005', listTime: '2022-11-20', dailySales: 89, dailyGMV: 'Â¥71,230', monthlySales: 1876, monthlyGMV: 'Â¥1,567,890', stock: 987, status: 'åœ¨å”®' }
            ],
            'ZMX002': [
                { name: 'ç”·å£«POLOè¡«', id: 'MPS001', listTime: '2023-05-10', dailySales: 145, dailyGMV: 'Â¥23,450', monthlySales: 3123, monthlyGMV: 'Â¥498,760', stock: 1876, status: 'åœ¨å”®' },
                { name: 'ç”·å£«ç‰›ä»”è£¤', id: 'MNZ002', listTime: '2023-03-28', dailySales: 167, dailyGMV: 'Â¥34,560', monthlySales: 3567, monthlyGMV: 'Â¥723,450', stock: 2345, status: 'åœ¨å”®' },
                { name: 'ç”·å£«çš®é‹', id: 'MPX003', listTime: '2023-02-15', dailySales: 98, dailyGMV: 'Â¥45,670', monthlySales: 2134, monthlyGMV: 'Â¥987,650', stock: 1234, status: 'åœ¨å”®' },
                { name: 'ç”·å£«å«è¡£', id: 'MWY004', listTime: '2023-04-05', dailySales: 156, dailyGMV: 'Â¥28,760', monthlySales: 3345, monthlyGMV: 'Â¥612,340', stock: 1876, status: 'åœ¨å”®' }
            ]
        };

        const contractData = {
            'dealer': [
                { name: 'å¼ æ˜è½©æ——èˆ°åº—', id: 'ZMX001', channel: 'å¤©çŒ«', openTime: '2019-06-10', dailyGMV: 'Â¥245,680', yoy: '+18.2%', mom: '+9.5%', targetRate: '94.2%' },
                { name: 'å¼ æ˜è½©äº¬ä¸œåº—', id: 'ZMX002', channel: 'äº¬ä¸œ', openTime: '2019-08-15', dailyGMV: 'Â¥156,790', yoy: '+12.5%', mom: '+6.8%', targetRate: '88.7%' },
                { name: 'å¼ æ˜è½©æ‹¼å¤šå¤šåº—', id: 'ZMX003', channel: 'æ‹¼å¤šå¤š', openTime: '2020-03-20', dailyGMV: 'Â¥98,450', yoy: '+22.3%', mom: '+12.7%', targetRate: '96.5%' }
            ],
            'supplier': [
                { name: 'æ­å·æœè£…ä¾›åº”å•†', id: 'GYS001', channel: 'ç›´ä¾›', openTime: '2018-12-05', dailyGMV: 'Â¥0', yoy: '+0%', mom: '+0%', targetRate: '100%' },
                { name: 'æµ™æ±Ÿé¢æ–™åˆä½œå•†', id: 'GYS002', channel: 'åˆä½œ', openTime: '2019-03-18', dailyGMV: 'Â¥0', yoy: '+0%', mom: '+0%', targetRate: '100%' }
            ],
            'other': [
                { name: 'å¼ æ˜è½©æŠ–éŸ³åº—', id: 'ZMX004', channel: 'æŠ–éŸ³', openTime: '2021-05-12', dailyGMV: 'Â¥68,000', yoy: '+45.2%', mom: '+28.9%', targetRate: '102.3%' },
                { name: 'å¼ æ˜è½©å¿«æ‰‹åº—', id: 'ZMX005', channel: 'å¿«æ‰‹', openTime: '2022-02-28', dailyGMV: 'Â¥32,450', yoy: '+38.7%', mom: '+22.5%', targetRate: '98.7%' },
                { name: 'å¼ æ˜è½©å°çº¢ä¹¦åº—', id: 'ZMX006', channel: 'å°çº¢ä¹¦', openTime: '2022-08-15', dailyGMV: 'Â¥18,760', yoy: '+52.3%', mom: '+34.8%', targetRate: '105.6%' },
                { name: 'å¼ æ˜è½©å¾®åšåº—', id: 'ZMX007', channel: 'å¾®åš', openTime: '2023-01-10', dailyGMV: 'Â¥12,340', yoy: '+67.8%', mom: '+45.2%', targetRate: '112.3%' },
                { name: 'å¼ æ˜è½©Bç«™åº—', id: 'ZMX008', channel: 'Bç«™', openTime: '2023-04-20', dailyGMV: 'Â¥8,760', yoy: '+78.9%', mom: '+56.7%', targetRate: '118.9%' }
            ]
        };

        // é¡µé¢åˆ‡æ¢å‡½æ•°
        function showPage(page) {
            document.getElementById('home-page').style.display = page === 'home' ? 'block' : 'none';
            document.getElementById('controller-page').style.display = page === 'controller' ? 'block' : 'none';
            document.getElementById('shop-page').style.display = page === 'shop' ? 'block' : 'none';
        }

        // æ˜¾ç¤ºå®æ§äººè¯¦æƒ…
        let currentController = 'å¼ æ˜è½©';
        
        function showControllerDetail(controllerName) {
            currentController = controllerName;
            const controller = controllers[controllerName];
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜å’Œæ ‡ç­¾
            document.getElementById('controller-name').innerHTML = `${controller.name} <span class="tag ${controller.tag}">${controller.tagText}</span>`;
            document.getElementById('controller-breadcrumb').textContent = `${controller.name} - å®æ§äººè¯¦æƒ…`;
            const backCtrlIcon = document.querySelector('#controller-page .breadcrumb .back-link');
            if (backCtrlIcon) backCtrlIcon.setAttribute('onclick', `showPage('home')`);
            document.getElementById('basic-name').textContent = controller.name;
            
            // æ›´æ–°å…³é”®æŒ‡æ ‡
            document.querySelectorAll('#controller-page .metric-card .metric-value')[0].textContent = controller.dailyGMV;
            document.querySelectorAll('#controller-page .metric-card .metric-value')[1].textContent = controller.monthlyGMV;
            document.querySelectorAll('#controller-page .metric-card .metric-value')[2].textContent = controller.yearlyGMV;
            document.querySelectorAll('#controller-page .metric-card .metric-value')[3].textContent = controller.targetRate;
            document.querySelector('#controller-page .progress-bar').style.width = controller.targetRate;
            
            // åŠ è½½GMVæ•°æ®
            loadGMVData(controllerName);
            
            // é»˜è®¤æ˜¾ç¤ºç»é”€å•†åˆåŒ
            showContract('dealer');
            
            // åˆ‡æ¢åˆ°å®æ§äººè¯¦æƒ…é¡µé¢
            showPage('controller');
        }

        // åŠ è½½GMVæ•°æ®
        function loadGMVData(controllerName) {
            const tableBody = document.getElementById('gmv-table-body');
            tableBody.innerHTML = '';
            
            if (shops[controllerName]) {
                shops[controllerName].forEach(shop => {
                    const row = document.createElement('tr');
                    row.className = 'shop-card';
                    row.onclick = () => showShopDetail(shop.id, controllerName);
                    
                    row.innerHTML = `
                        <td>${shop.name}</td>
                        <td>${shop.id}</td>
                        <td>${shop.channel}</td>
                        <td>${shop.openTime}</td>
                        <td>${shop.dailyGMV}</td>
                        <td>${shop.monthlyGMV}</td>
                        <td>${shop.yearlyGMV}</td>
                        <td class="positive">${shop.yoy}</td>
                        <td class="positive">${shop.mom}</td>
                        <td>
                            <div>${shop.targetRate}</div>
                            <div class="progress">
                                <div class="progress-bar bg-success" role="progressbar" style="width: ${shop.targetRate}" aria-valuenow="${parseFloat(shop.targetRate)}" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
        }

        // æ˜¾ç¤ºåˆåŒè¯¦æƒ…
        function showContract(type) {
            const contractTitle = document.getElementById('contract-title');
            const tableBody = document.getElementById('contract-table-body');
            tableBody.innerHTML = '';
            
            let title = '';
            let data = [];
            
            switch(type) {
                case 'dealer':
                    title = 'ç»é”€å•†åˆåŒè¯¦æƒ…';
                    data = contractData.dealer;
                    break;
                case 'supplier':
                    title = 'ä¾›åº”å•†åˆåŒè¯¦æƒ…';
                    data = contractData.supplier;
                    break;
                case 'other':
                    title = 'å…¶ä»–åˆåŒè¯¦æƒ…';
                    data = contractData.other;
                    break;
            }
            
            contractTitle.textContent = title;
            
            data.forEach(shop => {
                const row = document.createElement('tr');
                row.className = 'shop-card';
                row.onclick = () => showShopDetail(shop.id, currentController);
                
                row.innerHTML = `
                    <td>${shop.name}</td>
                    <td>${shop.id}</td>
                    <td>${shop.channel}</td>
                    <td>${shop.openTime}</td>
                    <td>${shop.dailyGMV}</td>
                    <td class="positive">${shop.yoy}</td>
                    <td class="positive">${shop.mom}</td>
                    <td>
                        <div>${shop.targetRate}</div>
                        <div class="progress">
                            <div class="progress-bar bg-success" role="progressbar" style="width: ${shop.targetRate}" aria-valuenow="${parseFloat(shop.targetRate)}" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // æ˜¾ç¤ºåº—é“ºè¯¦æƒ…
        function showShopDetail(shopId, controllerName) {
            // æŸ¥æ‰¾åº—é“ºä¿¡æ¯
            let shopInfo = null;
            if (shops[controllerName]) {
                shopInfo = shops[controllerName].find(shop => shop.id === shopId);
            }
            
            if (shopInfo) {
                // æ›´æ–°é¡µé¢æ ‡é¢˜
                document.getElementById('shop-name').textContent = shopInfo.name;
                document.getElementById('shop-id').textContent = shopInfo.id;
                document.getElementById('shop-open-time').textContent = shopInfo.openTime;
                document.getElementById('shop-channel').textContent = shopInfo.channel;
                document.getElementById('shop-breadcrumb').textContent = `${shopInfo.name} - åº—é“ºè¯¦æƒ…`;
                
                // æ›´æ–°è¿”å›é“¾æ¥ï¼ˆæ–‡å­—ä¸å·¦ä¾§å›¾æ ‡ä¸€è‡´ï¼‰
                document.getElementById('back-to-controller').setAttribute('onclick', `showControllerDetail('${controllerName}')`);
                const backIcon = document.getElementById('back-to-controller-icon');
                if (backIcon) backIcon.setAttribute('onclick', `showControllerDetail('${controllerName}')`);
                
                // æ›´æ–°å…³é”®æŒ‡æ ‡
                document.querySelectorAll('#shop-page .metric-card .metric-value')[0].textContent = shopInfo.dailyGMV;
                document.querySelectorAll('#shop-page .metric-card .metric-value')[1].textContent = shopInfo.monthlyGMV;
                document.querySelectorAll('#shop-page .metric-card .metric-value')[2].textContent = shopInfo.yearlyGMV;
                document.querySelectorAll('#shop-page .metric-card .metric-value')[3].textContent = shopInfo.targetRate;
                document.querySelector('#shop-page .progress-bar').style.width = shopInfo.targetRate;
                
                // åŠ è½½å•†å“æ•°æ®
                loadProductData(shopId);
                
                // åˆ‡æ¢åˆ°åº—é“ºè¯¦æƒ…é¡µé¢
                showPage('shop');
            }
        }

        // åŠ è½½å•†å“æ•°æ®
        function loadProductData(shopId) {
            const tableBody = document.getElementById('product-table-body');
            tableBody.innerHTML = '';
            
            if (products[shopId]) {
                products[shopId].forEach(product => {
                    const row = document.createElement('tr');
                    row.className = 'product-card';
                    
                    row.innerHTML = `
                        <td>${product.name}</td>
                        <td>${product.id}</td>
                        <td>${product.listTime}</td>
                        <td>${product.dailySales}</td>
                        <td>${product.dailyGMV}</td>
                        <td>${product.monthlySales}</td>
                        <td>${product.monthlyGMV}</td>
                        <td>${product.stock}</td>
                        <td><span class="tag tag-high-value">${product.status}</span></td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
        }

        // åˆ‡æ¢ä¿¡æ¯æ ‡ç­¾é¡µ
        function showInfo(section) {
            // éšè—æ‰€æœ‰ä¿¡æ¯åŒºåŸŸ
            document.querySelectorAll('.info-section').forEach(el => {
                el.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µçš„activeç±»
            document.querySelectorAll('.tab-button').forEach(el => {
                el.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„ä¿¡æ¯åŒºåŸŸ
            document.getElementById(section + '-info').classList.add('active');
            
            // ä¸ºå½“å‰æ ‡ç­¾é¡µæ·»åŠ activeç±»
            event.target.classList.add('active');
        }

        // åˆå§‹åŒ–å›¾è¡¨
        let channelChartInstance = null;
        let industryChartInstance = null;

        // é¢œè‰²å·¥å…·ï¼šHex <-> HSL
        function hexToRgb(hex){
            const h = hex.replace('#','');
            const bigint = parseInt(h.length===3 ? h.split('').map(c=>c+c).join('') : h, 16);
            return { r: (bigint>>16)&255, g: (bigint>>8)&255, b: bigint&255 };
        }
        function rgbToHsl(r,g,b){
            r/=255; g/=255; b/=255;
            const max=Math.max(r,g,b), min=Math.min(r,g,b);
            let h,s; const l=(max+min)/2;
            if(max===min){ h=s=0; } else {
                const d=max-min;
                s=l>0.5? d/(2-max-min): d/(max+min);
                switch(max){
                    case r: h=(g-b)/d+(g<b?6:0); break;
                    case g: h=(b-r)/d+2; break;
                    case b: h=(r-g)/d+4; break;
                }
                h/=6;
            }
            return { h: h*360, s: s*100, l: l*100 };
        }
        function hslToHex(h,s,l){
            h/=360; s/=100; l/=100;
            const hue2rgb=(p,q,t)=>{ if(t<0)t+=1; if(t>1)t-=1; if(t<1/6)return p+(q-p)*6*t; if(t<1/2)return q; if(t<2/3)return p+(q-p)*(2/3-t)*6; return p; };
            const q=l<0.5? l*(1+s): l+s-l*s; const p=2*l-q;
            const r=hue2rgb(p,q,h+1/3), g=hue2rgb(p,q,h), b=hue2rgb(p,q,h-1/3);
            const toHex=x=>{ const v=Math.round(x*255).toString(16).padStart(2,'0'); return v; };
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
        }
        function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }

        function getThemePalette(){
            const pc = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();
            const pd = getComputedStyle(document.documentElement).getPropertyValue('--primary-dark').trim();
            const pl = getComputedStyle(document.documentElement).getPropertyValue('--primary-light').trim();
            const {h,s,l} = rgbToHsl(...Object.values(hexToRgb(pc)));
            // ç”Ÿæˆ 6 è‰²ï¼šä¸»è‰²æ·±/ä¸»/æµ… + å·¦å³é‚»è¿‘è‰²ï¼ˆÂ±18Â°ï¼‰æ·±/æµ…ï¼Œä¿è¯å’Œè°ä¸”åŒºåˆ†
            const h1 = (h+360-18)%360, h2 = (h+18)%360;
            const palette = [
                hslToHex(h, clamp(s,30,85), clamp(l-10,25,60)),      // ä¸»è‰²åæ·±
                hslToHex(h, clamp(s,30,85), clamp(l,30,70)),         // ä¸»è‰²
                hslToHex(h, clamp(s-10,20,75), clamp(l+12,35,80)),   // ä¸»è‰²åæµ…
                hslToHex(h1, clamp(s,30,85), clamp(l-2,28,65)),      // å·¦é‚»è¿‘
                hslToHex(h2, clamp(s,30,85), clamp(l+4,32,72)),      // å³é‚»è¿‘
                hslToHex(h2, clamp(s-5,25,70), clamp(l-14,25,60))    // å³é‚»è¿‘åæ·±
            ];
            const contrastA = pd;            // æœ¬å“ç‰ŒæŸ±
            const contrastB = '#8e9aa3';     // è¡Œä¸šå¯¹æ¯”æŸ±ï¼ˆä¸­æ€§ç°è“ï¼‰
            return { palette, contrastA, contrastB };
        }

        function initCharts() {
            const { palette, contrastA, contrastB } = getThemePalette();
            // æ¸ é“åˆ†å¸ƒå›¾è¡¨
            const channelCtx = document.getElementById('channelChart').getContext('2d');
            channelChartInstance = new Chart(channelCtx, {
                type: 'doughnut',
                data: {
                    labels: ['å¤©çŒ«', 'äº¬ä¸œ', 'æ‹¼å¤šå¤š', 'æŠ–éŸ³', 'å¿«æ‰‹', 'å…¶ä»–'],
                    datasets: [{
                        data: [35, 25, 15, 12, 8, 5],
                        backgroundColor: palette,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });

            // è¡Œä¸šå¤§ç›˜å›¾è¡¨
            const industryCtx = document.getElementById('industryChart').getContext('2d');
            industryChartInstance = new Chart(industryCtx, {
                type: 'bar',
                data: {
                    labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ'],
                    datasets: [{
                        label: 'å®æ§äººGMV',
                        data: [10500000, 11200000, 10800000, 12500000, 13200000, 12800000, 14200000, 13800000, 14500000, 15600000],
                        backgroundColor: contrastA,
                        borderColor: contrastA,
                        borderWidth: 1
                    }, {
                        label: 'è¡Œä¸šå¹³å‡GMV',
                        data: [9800000, 10100000, 9950000, 10800000, 11200000, 11000000, 11800000, 11500000, 12200000, 12800000],
                        backgroundColor: contrastB,
                        borderColor: contrastB,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'Â¥' + (value / 10000) + 'ä¸‡';
                                }
                            }
                        }
                    }
                }
            });

            // å•†å“é”€å”®è¶‹åŠ¿å›¾è¡¨
            const productTrendCtx = document.getElementById('productTrendChart').getContext('2d');
            new Chart(productTrendCtx, {
                type: 'line',
                data: {
                    labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ'],
                    datasets: [{
                        label: 'ç”·å£«ä¼‘é—²å¤¹å…‹',
                        data: [45000, 52000, 48000, 61000, 65000, 58000, 72000, 68000, 75000, 82000],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        tension: 0.3
                    }, {
                        label: 'ç”·å£«å•†åŠ¡è¡¬è¡«',
                        data: [38000, 42000, 39000, 48000, 52000, 45000, 56000, 53000, 59000, 64000],
                        borderColor: '#2ecc71',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        borderWidth: 2,
                        tension: 0.3
                    }, {
                        label: 'ç”·å£«ä¼‘é—²è£¤',
                        data: [32000, 35000, 33000, 41000, 44000, 38000, 47000, 45000, 49000, 53000],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 2,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'Â¥' + (value / 1000) + 'åƒ';
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateChartColors(){
            const { palette, contrastA, contrastB } = getThemePalette();
            if (channelChartInstance){
                channelChartInstance.data.datasets[0].backgroundColor = palette;
                channelChartInstance.update();
            }
            if (industryChartInstance){
                industryChartInstance.data.datasets[0].backgroundColor = contrastA;
                industryChartInstance.data.datasets[0].borderColor = contrastA;
                industryChartInstance.data.datasets[1].backgroundColor = contrastB;
                industryChartInstance.data.datasets[1].borderColor = contrastB;
                industryChartInstance.update();
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åº”ç”¨ä¿å­˜çš„ä¸»é¢˜
            applyTheme(localStorage.getItem('selectedTheme') || 'gold');
            // æ¨è¿Ÿå›¾è¡¨åˆå§‹åŒ–ï¼Œç­‰ä¸»çº¿ç¨‹ç©ºé—²
            (window.requestIdleCallback || window.requestAnimationFrame)(function(){
                try { initCharts(); } catch(e) { console.warn(e); }
            });
            updateCurrentSelectionLabel();
            
            // æ–‡ä»¶ä¸Šä¼ äº‹ä»¶
            document.getElementById('fileInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });

            // æ‹–æ‹½ä¸Šä¼ 
            const uploadArea = document.getElementById('uploadArea');
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });
            
            // é»˜è®¤æ˜¾ç¤ºç»é”€å•†åˆåŒ
            showContract('dealer');
            
            // è®¾ç½®è¿”å›æŒ‰é’®äº‹ä»¶
            document.getElementById('back-to-controller').addEventListener('click', function() {
                showControllerDetail(currentController);
            });
            
            // è®¾ç½®æ¸ é“ç­›é€‰äº‹ä»¶
            document.getElementById('channel-filter').addEventListener('change', function() {
                // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ ¹æ®ç­›é€‰æ¡ä»¶é‡æ–°åŠ è½½æ•°æ®
                console.log('æ¸ é“ç­›é€‰:', this.value);
            });
        });
    </script>
</body>
</html>
